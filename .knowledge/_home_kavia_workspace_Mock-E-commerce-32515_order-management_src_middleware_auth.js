{"is_source_file": true, "format": "JavaScript", "description": "Middleware for authenticating JWT tokens and authorizing users in an Express application.", "external_files": ["../config/auth", "../services/userService"], "external_methods": ["userService.verifyToken", "userService.validateUser", "userService.isAdmin"], "published": ["authenticateToken", "userExists", "isAdmin", "isResourceOwner"], "classes": [], "methods": [], "calls": ["jwt.verify", "userService.verifyToken", "userService.validateUser", "userService.isAdmin"], "search-terms": ["authenticateToken", "isAdmin", "userExists", "isResourceOwner"], "state": 2, "file_id": 42, "knowledge_revision": 154, "git_revision": "69a514964ce5aea190e7c2b6ed9c87ef2f95e4a8", "revision_history": [{"91": ""}, {"114": "afef8557091f4665925a3c7c75720cebc364fbe9"}, {"154": "69a514964ce5aea190e7c2b6ed9c87ef2f95e4a8"}], "ctags": [{"_type": "tag", "name": "authConfig", "path": "/home/kavia/workspace/Mock-E-commerce-32515/order-management/src/middleware/auth.js", "pattern": "/^const authConfig = require('..\\/config\\/auth');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "authHeader", "path": "/home/kavia/workspace/Mock-E-commerce-32515/order-management/src/middleware/auth.js", "pattern": "/^    const authHeader = req.headers['authorization'];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "authHeader", "path": "/home/kavia/workspace/Mock-E-commerce-32515/order-management/src/middleware/auth.js", "pattern": "/^  const authHeader = req.headers['authorization'];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "authenticateToken", "path": "/home/kavia/workspace/Mock-E-commerce-32515/order-management/src/middleware/auth.js", "pattern": "/^  authenticateToken,$/", "language": "JavaScript", "kind": "field", "scope": "module.exports", "scopeKind": "class"}, {"_type": "tag", "name": "authenticateToken", "path": "/home/kavia/workspace/Mock-E-commerce-32515/order-management/src/middleware/auth.js", "pattern": "/^const authenticateToken = async (req, res, next) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "decoded", "path": "/home/kavia/workspace/Mock-E-commerce-32515/order-management/src/middleware/auth.js", "pattern": "/^    const decoded = jwt.verify(token, authConfig.jwtSecret);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "isAdmin", "path": "/home/kavia/workspace/Mock-E-commerce-32515/order-management/src/middleware/auth.js", "pattern": "/^const isAdmin = async (req, res, next) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "isResourceOwner", "path": "/home/kavia/workspace/Mock-E-commerce-32515/order-management/src/middleware/auth.js", "pattern": "/^const isResourceOwner = async (req, res, next) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "isUserAdmin", "path": "/home/kavia/workspace/Mock-E-commerce-32515/order-management/src/middleware/auth.js", "pattern": "/^    const isUserAdmin = await userService.isAdmin(req.user.id, token);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "jwt", "path": "/home/kavia/workspace/Mock-E-commerce-32515/order-management/src/middleware/auth.js", "pattern": "/^const jwt = require('jsonwebtoken');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "resourceUserId", "path": "/home/kavia/workspace/Mock-E-commerce-32515/order-management/src/middleware/auth.js", "pattern": "/^  const resourceUserId = req.params.userId || req.body.userId;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "token", "path": "/home/kavia/workspace/Mock-E-commerce-32515/order-management/src/middleware/auth.js", "pattern": "/^    const token = authHeader && authHeader.split(' ')[1];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "token", "path": "/home/kavia/workspace/Mock-E-commerce-32515/order-management/src/middleware/auth.js", "pattern": "/^  const token = authHeader && authHeader.split(' ')[1];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "userData", "path": "/home/kavia/workspace/Mock-E-commerce-32515/order-management/src/middleware/auth.js", "pattern": "/^      const userData = await userService.verifyToken(token);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "userExists", "path": "/home/kavia/workspace/Mock-E-commerce-32515/order-management/src/middleware/auth.js", "pattern": "/^    const userExists = await userService.validateUser(userId, token);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "userExists", "path": "/home/kavia/workspace/Mock-E-commerce-32515/order-management/src/middleware/auth.js", "pattern": "/^const userExists = async (req, res, next) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "userId", "path": "/home/kavia/workspace/Mock-E-commerce-32515/order-management/src/middleware/auth.js", "pattern": "/^    const userId = req.params.userId || req.body.userId || (req.user && req.user.id);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "userService", "path": "/home/kavia/workspace/Mock-E-commerce-32515/order-management/src/middleware/auth.js", "pattern": "/^const userService = require('..\\/services\\/userService');$/", "language": "JavaScript", "kind": "constant"}], "filename": "/home/kavia/workspace/Mock-E-commerce-32515/order-management/src/middleware/auth.js", "hash": "9e6fafae396cf46070cff89b4e9fed62", "format-version": 4, "code-base-name": "default", "fields": [{"name": "authenticateToken,", "scope": "module.exports", "scopeKind": "class", "description": "unavailable"}]}