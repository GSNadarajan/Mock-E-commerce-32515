{"is_source_file": true, "format": "JavaScript", "description": "This file defines a UserModel class that manages user data operations using a JSON file for storage, including methods for creating, reading, updating, and deleting users.", "external_files": ["../data/users.json"], "external_methods": ["fs.promises.access", "fs.promises.readFile", "fs.promises.writeFile", "fs.promises.rename"], "published": ["UserModel", "createUser", "getAllUsers", "getUserById", "getUserByEmail", "getUserByVerificationToken", "getUserByResetToken", "updateUser", "deleteUser", "verifyUser", "setPasswordResetToken", "resetPassword", "findUsersByRole", "searchUsers", "countUsers"], "classes": [{"name": "UserModel", "description": "Class to handle user data operations, including initialization of the data file, CRUD operations, and user verification."}], "methods": [{"name": "initialize()", "description": "Checks if the users.json file exists and creates it if it does not.", "scope": "UserModel", "scopeKind": "class"}, {"name": "_readData()", "description": "Reads user data from the users.json file and parses it as JSON.", "scope": "UserModel", "scopeKind": "class"}, {"name": "_writeData(data)", "description": "Writes user data to the users.json file in a safe manner using a temporary file.", "scope": "UserModel", "scopeKind": "class"}, {"name": "getAllUsers()", "description": "Returns a list of all users.", "scope": "UserModel", "scopeKind": "class"}, {"name": "getUserById(id)", "description": "Retrieves a user by their unique ID.", "scope": "UserModel", "scopeKind": "class"}, {"name": "getUserByEmail(email)", "description": "Retrieves a user by their email address.", "scope": "UserModel", "scopeKind": "class"}, {"name": "getUserByVerificationToken(token)", "description": "Retrieves a user by their verification token.", "scope": "UserModel", "scopeKind": "class"}, {"name": "getUserByResetToken(token)", "description": "Retrieves a user by their password reset token.", "scope": "UserModel", "scopeKind": "class"}, {"name": "createUser(userData)", "description": "Creates a new user with the provided user data and returns the created user object.", "scope": "UserModel", "scopeKind": "class"}, {"name": "updateUser(id, userData)", "description": "Updates an existing user's data and returns the updated user object.", "scope": "UserModel", "scopeKind": "class"}, {"name": "deleteUser(id)", "description": "Deletes a user by their unique ID and returns a boolean indicating success.", "scope": "UserModel", "scopeKind": "class"}, {"name": "verifyUser(token)", "description": "Verifies a user's email using a verification token.", "scope": "UserModel", "scopeKind": "class"}, {"name": "setPasswordResetToken(email, token, expiry)", "description": "Sets a password reset token for a user identified by their email.", "scope": "UserModel", "scopeKind": "class"}, {"name": "resetPassword(token, newPassword)", "description": "Resets a user's password using a reset token.", "scope": "UserModel", "scopeKind": "class"}, {"name": "findUsersByRole(role)", "description": "Finds users with a specific role.", "scope": "UserModel", "scopeKind": "class"}, {"name": "searchUsers(query)", "description": "Searches for users by username or email.", "scope": "UserModel", "scopeKind": "class"}, {"name": "countUsers()", "description": "Counts the total number of users in the system.", "scope": "UserModel", "scopeKind": "class"}], "calls": ["fs.promises.access", "fs.promises.readFile", "fs.promises.writeFile", "fs.promises.rename"], "search-terms": ["UserModel", "users.json", "User data storage", "CRUD operations"], "state": 2, "file_id": 5, "knowledge_revision": 34, "git_revision": "8d0cf020db542046a443b905d4680ea8a28a859e", "revision_history": [{"15": ""}, {"34": "8d0cf020db542046a443b905d4680ea8a28a859e"}], "ctags": [{"_type": "tag", "name": "UserModel", "path": "/home/kavia/workspace/Mock-E-commerce-32515/src/models/userModel.js", "pattern": "/^class UserModel {$/", "language": "JavaScript", "kind": "class"}, {"_type": "tag", "name": "_readData", "path": "/home/kavia/workspace/Mock-E-commerce-32515/src/models/userModel.js", "pattern": "/^  static async _readData() {$/", "language": "JavaScript", "kind": "method", "signature": "()", "scope": "UserModel", "scopeKind": "class"}, {"_type": "tag", "name": "_writeData", "path": "/home/kavia/workspace/Mock-E-commerce-32515/src/models/userModel.js", "pattern": "/^  static async _writeData(data) {$/", "language": "JavaScript", "kind": "method", "signature": "(data)", "scope": "UserModel", "scopeKind": "class"}, {"_type": "tag", "name": "countUsers", "path": "/home/kavia/workspace/Mock-E-commerce-32515/src/models/userModel.js", "pattern": "/^  static async countUsers() {$/", "language": "JavaScript", "kind": "method", "signature": "()", "scope": "UserModel", "scopeKind": "class"}, {"_type": "tag", "name": "createUser", "path": "/home/kavia/workspace/Mock-E-commerce-32515/src/models/userModel.js", "pattern": "/^  static async createUser(userData) {$/", "language": "JavaScript", "kind": "method", "signature": "(userData)", "scope": "UserModel", "scopeKind": "class"}, {"_type": "tag", "name": "createdAt", "path": "/home/kavia/workspace/Mock-E-commerce-32515/src/models/userModel.js", "pattern": "/^      createdAt: new Date().toISOString(),$/", "language": "JavaScript", "kind": "property", "scope": "UserModel.createUser.newUser", "scopeKind": "class"}, {"_type": "tag", "name": "dbPath", "path": "/home/kavia/workspace/Mock-E-commerce-32515/src/models/userModel.js", "pattern": "/^const dbPath = path.join(__dirname, '..\\/data\\/users.json');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "deleteUser", "path": "/home/kavia/workspace/Mock-E-commerce-32515/src/models/userModel.js", "pattern": "/^  static async deleteUser(id) {$/", "language": "JavaScript", "kind": "method", "signature": "(id)", "scope": "UserModel", "scopeKind": "class"}, {"_type": "tag", "name": "email", "path": "/home/kavia/workspace/Mock-E-commerce-32515/src/models/userModel.js", "pattern": "/^      email: userData.email,$/", "language": "JavaScript", "kind": "property", "scope": "UserModel.createUser.newUser", "scopeKind": "class"}, {"_type": "tag", "name": "findUsersByRole", "path": "/home/kavia/workspace/Mock-E-commerce-32515/src/models/userModel.js", "pattern": "/^  static async findUsersByRole(role) {$/", "language": "JavaScript", "kind": "method", "signature": "(role)", "scope": "UserModel", "scopeKind": "class"}, {"_type": "tag", "name": "fs", "path": "/home/kavia/workspace/Mock-E-commerce-32515/src/models/userModel.js", "pattern": "/^const fs = require('fs').promises;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "getAllUsers", "path": "/home/kavia/workspace/Mock-E-commerce-32515/src/models/userModel.js", "pattern": "/^  static async getAllUsers() {$/", "language": "JavaScript", "kind": "method", "signature": "()", "scope": "UserModel", "scopeKind": "class"}, {"_type": "tag", "name": "getUserByEmail", "path": "/home/kavia/workspace/Mock-E-commerce-32515/src/models/userModel.js", "pattern": "/^  static async getUserByEmail(email) {$/", "language": "JavaScript", "kind": "method", "signature": "(email)", "scope": "UserModel", "scopeKind": "class"}, {"_type": "tag", "name": "getUserById", "path": "/home/kavia/workspace/Mock-E-commerce-32515/src/models/userModel.js", "pattern": "/^  static async getUserById(id) {$/", "language": "JavaScript", "kind": "method", "signature": "(id)", "scope": "UserModel", "scopeKind": "class"}, {"_type": "tag", "name": "getUserByResetToken", "path": "/home/kavia/workspace/Mock-E-commerce-32515/src/models/userModel.js", "pattern": "/^  static async getUserByResetToken(token) {$/", "language": "JavaScript", "kind": "method", "signature": "(token)", "scope": "UserModel", "scopeKind": "class"}, {"_type": "tag", "name": "getUserByVerificationToken", "path": "/home/kavia/workspace/Mock-E-commerce-32515/src/models/userModel.js", "pattern": "/^  static async getUserByVerificationToken(token) {$/", "language": "JavaScript", "kind": "method", "signature": "(token)", "scope": "UserModel", "scopeKind": "class"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/Mock-E-commerce-32515/src/models/userModel.js", "pattern": "/^      id: uuidv4(),$/", "language": "JavaScript", "kind": "property", "scope": "UserModel.createUser.newUser", "scopeKind": "class"}, {"_type": "tag", "name": "initialize", "path": "/home/kavia/workspace/Mock-E-commerce-32515/src/models/userModel.js", "pattern": "/^  static async initialize() {$/", "language": "JavaScript", "kind": "method", "signature": "()", "scope": "UserModel", "scopeKind": "class"}, {"_type": "tag", "name": "isVerified", "path": "/home/kavia/workspace/Mock-E-commerce-32515/src/models/userModel.js", "pattern": "/^      isVerified: userData.isVerified !== undefined ? userData.isVerified : false,$/", "language": "JavaScript", "kind": "property", "scope": "UserModel.createUser.newUser", "scopeKind": "class"}, {"_type": "tag", "name": "lastLogin", "path": "/home/kavia/workspace/Mock-E-commerce-32515/src/models/userModel.js", "pattern": "/^      lastLogin: null$/", "language": "JavaScript", "kind": "property", "scope": "UserModel.createUser.newUser", "scopeKind": "class"}, {"_type": "tag", "name": "newUser", "path": "/home/kavia/workspace/Mock-E-commerce-32515/src/models/userModel.js", "pattern": "/^    const newUser = {$/", "language": "JavaScript", "kind": "class", "scope": "UserModel.createUser", "scopeKind": "class"}, {"_type": "tag", "name": "password", "path": "/home/kavia/workspace/Mock-E-commerce-32515/src/models/userModel.js", "pattern": "/^      password: userData.password, \\/\\/ Should be pre-hashed$/", "language": "JavaScript", "kind": "property", "scope": "UserModel.createUser.newUser", "scopeKind": "class"}, {"_type": "tag", "name": "path", "path": "/home/kavia/workspace/Mock-E-commerce-32515/src/models/userModel.js", "pattern": "/^const path = require('path');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "resetPassword", "path": "/home/kavia/workspace/Mock-E-commerce-32515/src/models/userModel.js", "pattern": "/^  static async resetPassword(token, newPassword) {$/", "language": "JavaScript", "kind": "method", "signature": "(token, newPassword)", "scope": "UserModel", "scopeKind": "class"}, {"_type": "tag", "name": "resetToken", "path": "/home/kavia/workspace/Mock-E-commerce-32515/src/models/userModel.js", "pattern": "/^      resetToken: userData.resetToken || null,$/", "language": "JavaScript", "kind": "property", "scope": "UserModel.createUser.newUser", "scopeKind": "class"}, {"_type": "tag", "name": "resetTokenExpiry", "path": "/home/kavia/workspace/Mock-E-commerce-32515/src/models/userModel.js", "pattern": "/^      resetTokenExpiry: userData.resetTokenExpiry || null,$/", "language": "JavaScript", "kind": "property", "scope": "UserModel.createUser.newUser", "scopeKind": "class"}, {"_type": "tag", "name": "role", "path": "/home/kavia/workspace/Mock-E-commerce-32515/src/models/userModel.js", "pattern": "/^      role: userData.role || 'user',$/", "language": "JavaScript", "kind": "property", "scope": "UserModel.createUser.newUser", "scopeKind": "class"}, {"_type": "tag", "name": "searchUsers", "path": "/home/kavia/workspace/Mock-E-commerce-32515/src/models/userModel.js", "pattern": "/^  static async searchUsers(query) {$/", "language": "JavaScript", "kind": "method", "signature": "(query)", "scope": "UserModel", "scopeKind": "class"}, {"_type": "tag", "name": "setPasswordResetToken", "path": "/home/kavia/workspace/Mock-E-commerce-32515/src/models/userModel.js", "pattern": "/^  static async setPasswordResetToken(email, token, expiry) {$/", "language": "JavaScript", "kind": "method", "signature": "(email, token, expiry)", "scope": "UserModel", "scopeKind": "class"}, {"_type": "tag", "name": "updateUser", "path": "/home/kavia/workspace/Mock-E-commerce-32515/src/models/userModel.js", "pattern": "/^  static async updateUser(id, userData) {$/", "language": "JavaScript", "kind": "method", "signature": "(id, userData)", "scope": "UserModel", "scopeKind": "class"}, {"_type": "tag", "name": "updatedAt", "path": "/home/kavia/workspace/Mock-E-commerce-32515/src/models/userModel.js", "pattern": "/^      updatedAt: new Date().toISOString(),$/", "language": "JavaScript", "kind": "property", "scope": "UserModel.createUser.newUser", "scopeKind": "class"}, {"_type": "tag", "name": "username", "path": "/home/kavia/workspace/Mock-E-commerce-32515/src/models/userModel.js", "pattern": "/^      username: userData.username,$/", "language": "JavaScript", "kind": "property", "scope": "UserModel.createUser.newUser", "scopeKind": "class"}, {"_type": "tag", "name": "verificationToken", "path": "/home/kavia/workspace/Mock-E-commerce-32515/src/models/userModel.js", "pattern": "/^      verificationToken: userData.verificationToken || null,$/", "language": "JavaScript", "kind": "property", "scope": "UserModel.createUser.newUser", "scopeKind": "class"}, {"_type": "tag", "name": "verifyUser", "path": "/home/kavia/workspace/Mock-E-commerce-32515/src/models/userModel.js", "pattern": "/^  static async verifyUser(token) {$/", "language": "JavaScript", "kind": "method", "signature": "(token)", "scope": "UserModel", "scopeKind": "class"}], "filename": "/home/kavia/workspace/Mock-E-commerce-32515/src/models/userModel.js", "hash": "ced687cb856ed8321cbde7f4b9b9dcd3", "format-version": 4, "code-base-name": "default", "fields": [{"name": "createdAt: new Date().toISOString(),", "scope": "UserModel.createUser.newUser", "scopeKind": "class", "description": "unavailable"}, {"name": "email: userData.email,", "scope": "UserModel.createUser.newUser", "scopeKind": "class", "description": "unavailable"}, {"name": "id: uuidv4(),", "scope": "UserModel.createUser.newUser", "scopeKind": "class", "description": "unavailable"}, {"name": "isVerified: userData.isVerified !== undefined ? userData.isVerified : false,", "scope": "UserModel.createUser.newUser", "scopeKind": "class", "description": "unavailable"}, {"name": "lastLogin: null", "scope": "UserModel.createUser.newUser", "scopeKind": "class", "description": "unavailable"}, {"name": "password: userData.password, \\/\\/ Should be pre-hashed", "scope": "UserModel.createUser.newUser", "scopeKind": "class", "description": "unavailable"}, {"name": "resetToken: userData.resetToken || null,", "scope": "UserModel.createUser.newUser", "scopeKind": "class", "description": "unavailable"}, {"name": "resetTokenExpiry: userData.resetTokenExpiry || null,", "scope": "UserModel.createUser.newUser", "scopeKind": "class", "description": "unavailable"}, {"name": "role: userData.role || 'user',", "scope": "UserModel.createUser.newUser", "scopeKind": "class", "description": "unavailable"}, {"name": "updatedAt: new Date().toISOString(),", "scope": "UserModel.createUser.newUser", "scopeKind": "class", "description": "unavailable"}, {"name": "username: userData.username,", "scope": "UserModel.createUser.newUser", "scopeKind": "class", "description": "unavailable"}, {"name": "verificationToken: userData.verificationToken || null,", "scope": "UserModel.createUser.newUser", "scopeKind": "class", "description": "unavailable"}]}